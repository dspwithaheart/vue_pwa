(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["forcegraph~shaders~unrealbloom"],{"1b53":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r("5a89");function o(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(o.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),o.FullScreenQuad=function(){var e=new i["db"](-1,1,1,-1,0,1),t=new i["gb"](2,2),r=function(e){this._mesh=new i["R"](t,e)};return Object.defineProperty(r.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(r.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(t){t.render(this._mesh,e)}}),r}()},"32d9":function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var i=r("5a89"),o=r("e9d2"),a=r("1b53"),s=function(e,t){a["a"].call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof i["ub"]?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=i["Ib"].clone(e.uniforms),this.material=new i["ub"]({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new a["a"].FullScreenQuad(this.material)};s.prototype=Object.assign(Object.create(a["a"].prototype),{constructor:s,render:function(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}});var n=function(e,t){a["a"].call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1};n.prototype=Object.assign(Object.create(a["a"].prototype),{constructor:n,render:function(e,t,r){var i,o,a=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(i=0,o=1):(i=1,o=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),s.buffers.stencil.setFunc(a.ALWAYS,i,4294967295),s.buffers.stencil.setClear(o),s.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(a.EQUAL,1,4294967295),s.buffers.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),s.buffers.stencil.setLocked(!0)}});var l=function(){a["a"].call(this),this.needsSwap=!1};l.prototype=Object.create(a["a"].prototype),Object.assign(l.prototype,{render:function(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}});var u=function(e,t){if(this.renderer=e,void 0===t){var r={minFilter:i["I"],magFilter:i["I"],format:i["ob"],stencilBuffer:!1},a=e.getSize(new i["Jb"]);this._pixelRatio=e.getPixelRatio(),this._width=a.width,this._height=a.height,t=new i["Mb"](this._width*this._pixelRatio,this._height*this._pixelRatio,r),t.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===o["a"]&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===s&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new s(o["a"]),this.clock=new i["m"]};Object.assign(u.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(e,t){this.passes.splice(t,0,e)},isLastEnabledPass:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(e){void 0===e&&(e=this.clock.getDelta());var t,r,i=this.renderer.getRenderTarget(),o=!1,a=this.passes.length;for(r=0;r<a;r++)if(t=this.passes[r],!1!==t.enabled){if(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,o),t.needsSwap){if(o){var s=this.renderer.getContext(),u=this.renderer.state.buffers.stencil;u.setFunc(s.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),u.setFunc(s.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==n&&(t instanceof n?o=!0:t instanceof l&&(o=!1))}this.renderer.setRenderTarget(i)},reset:function(e){if(void 0===e){var t=this.renderer.getSize(new i["Jb"]);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this._width=e,this._height=t;var r=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(r,i),this.renderTarget2.setSize(r,i);for(var o=0;o<this.passes.length;o++)this.passes[o].setSize(r,i)},setPixelRatio:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}});var h=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1};Object.assign(h.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),h.FullScreenQuad=function(){var e=new i["db"](-1,1,1,-1,0,1),t=new i["gb"](2,2),r=function(e){this._mesh=new i["R"](t,e)};return Object.defineProperty(r.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(r.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(t){t.render(this._mesh,e)}}),r}()},4721:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r("5a89"),o=function(e,t){void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.enabled=!0,this.target=new i["Kb"],this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:i["N"].ROTATE,MIDDLE:i["N"].DOLLY,RIGHT:i["N"].PAN},this.touches={ONE:i["Cb"].ROTATE,TWO:i["Cb"].DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return h.phi},this.getAzimuthalAngle=function(){return h.theta},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(o),r.update(),l=n.NONE},this.update=function(){var t=new i["Kb"],a=(new i["mb"]).setFromUnitVectors(e.up,new i["Kb"](0,1,0)),s=a.clone().inverse(),p=new i["Kb"],b=new i["mb"];return function(){var e=r.object.position;return t.copy(e).sub(r.target),t.applyQuaternion(a),h.setFromVector3(t),r.autoRotate&&l===n.NONE&&M(S()),r.enableDamping?(h.theta+=c.theta*r.dampingFactor,h.phi+=c.phi*r.dampingFactor):(h.theta+=c.theta,h.phi+=c.phi),h.theta=Math.max(r.minAzimuthAngle,Math.min(r.maxAzimuthAngle,h.theta)),h.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=d,h.radius=Math.max(r.minDistance,Math.min(r.maxDistance,h.radius)),!0===r.enableDamping?r.target.addScaledVector(m,r.dampingFactor):r.target.add(m),t.setFromSpherical(h),t.applyQuaternion(s),e.copy(r.target).add(t),r.object.lookAt(r.target),!0===r.enableDamping?(c.theta*=1-r.dampingFactor,c.phi*=1-r.dampingFactor,m.multiplyScalar(1-r.dampingFactor)):(c.set(0,0,0),m.set(0,0,0)),d=1,!!(f||p.distanceToSquared(r.object.position)>u||8*(1-b.dot(r.object.quaternion))>u)&&(r.dispatchEvent(o),p.copy(r.object.position),b.copy(r.object.quaternion),f=!1,!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",ne,!1),r.domElement.removeEventListener("mousedown",$,!1),r.domElement.removeEventListener("wheel",re,!1),r.domElement.removeEventListener("touchstart",oe,!1),r.domElement.removeEventListener("touchend",se,!1),r.domElement.removeEventListener("touchmove",ae,!1),document.removeEventListener("mousemove",ee,!1),document.removeEventListener("mouseup",te,!1),r.domElement.removeEventListener("keydown",ie,!1)};var r=this,o={type:"change"},a={type:"start"},s={type:"end"},n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},l=n.NONE,u=1e-6,h=new i["Ab"],c=new i["Ab"],d=1,m=new i["Kb"],f=!1,p=new i["Jb"],b=new i["Jb"],v=new i["Jb"],g=new i["Jb"],T=new i["Jb"],x=new i["Jb"],E=new i["Jb"],w=new i["Jb"],y=new i["Jb"];function S(){return 2*Math.PI/60/60*r.autoRotateSpeed}function C(){return Math.pow(.95,r.zoomSpeed)}function M(e){c.theta-=e}function O(e){c.phi-=e}var P=function(){var e=new i["Kb"];return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),m.add(e)}}(),R=function(){var e=new i["Kb"];return function(t,i){!0===r.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),m.add(e)}}(),D=function(){var e=new i["Kb"];return function(t,i){var o=r.domElement;if(r.object.isPerspectiveCamera){var a=r.object.position;e.copy(a).sub(r.target);var s=e.length();s*=Math.tan(r.object.fov/2*Math.PI/180),P(2*t*s/o.clientHeight,r.object.matrix),R(2*i*s/o.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(P(t*(r.object.right-r.object.left)/r.object.zoom/o.clientWidth,r.object.matrix),R(i*(r.object.top-r.object.bottom)/r.object.zoom/o.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function L(e){r.object.isPerspectiveCamera?d/=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*e)),r.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function A(e){r.object.isPerspectiveCamera?d*=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/e)),r.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function _(e){p.set(e.clientX,e.clientY)}function j(e){E.set(e.clientX,e.clientY)}function N(e){g.set(e.clientX,e.clientY)}function U(e){b.set(e.clientX,e.clientY),v.subVectors(b,p).multiplyScalar(r.rotateSpeed);var t=r.domElement;M(2*Math.PI*v.x/t.clientHeight),O(2*Math.PI*v.y/t.clientHeight),p.copy(b),r.update()}function B(e){w.set(e.clientX,e.clientY),y.subVectors(w,E),y.y>0?L(C()):y.y<0&&A(C()),E.copy(w),r.update()}function k(e){T.set(e.clientX,e.clientY),x.subVectors(T,g).multiplyScalar(r.panSpeed),D(x.x,x.y),g.copy(T),r.update()}function z(){}function F(e){e.deltaY<0?A(C()):e.deltaY>0&&L(C()),r.update()}function H(e){var t=!1;switch(e.keyCode){case r.keys.UP:D(0,r.keyPanSpeed),t=!0;break;case r.keys.BOTTOM:D(0,-r.keyPanSpeed),t=!0;break;case r.keys.LEFT:D(r.keyPanSpeed,0),t=!0;break;case r.keys.RIGHT:D(-r.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),r.update())}function Y(e){if(1==e.touches.length)p.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);p.set(t,r)}}function I(e){if(1==e.touches.length)g.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);g.set(t,r)}}function K(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+r*r);E.set(0,i)}function Q(e){r.enableZoom&&K(e),r.enablePan&&I(e)}function V(e){r.enableZoom&&K(e),r.enableRotate&&Y(e)}function X(e){if(1==e.touches.length)b.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);b.set(t,i)}v.subVectors(b,p).multiplyScalar(r.rotateSpeed);var o=r.domElement;M(2*Math.PI*v.x/o.clientHeight),O(2*Math.PI*v.y/o.clientHeight),p.copy(b)}function J(e){if(1==e.touches.length)T.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);T.set(t,i)}x.subVectors(T,g).multiplyScalar(r.panSpeed),D(x.x,x.y),g.copy(T)}function Z(e){var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+i*i);w.set(0,o),y.set(0,Math.pow(w.y/E.y,r.zoomSpeed)),L(y.y),E.copy(w)}function W(e){r.enableZoom&&Z(e),r.enablePan&&J(e)}function G(e){r.enableZoom&&Z(e),r.enableRotate&&X(e)}function q(){}function $(e){if(!1!==r.enabled){var t;switch(e.preventDefault(),r.domElement.focus?r.domElement.focus():window.focus(),e.button){case 0:t=r.mouseButtons.LEFT;break;case 1:t=r.mouseButtons.MIDDLE;break;case 2:t=r.mouseButtons.RIGHT;break;default:t=-1}switch(t){case i["N"].DOLLY:if(!1===r.enableZoom)return;j(e),l=n.DOLLY;break;case i["N"].ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enablePan)return;N(e),l=n.PAN}else{if(!1===r.enableRotate)return;_(e),l=n.ROTATE}break;case i["N"].PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enableRotate)return;_(e),l=n.ROTATE}else{if(!1===r.enablePan)return;N(e),l=n.PAN}break;default:l=n.NONE}l!==n.NONE&&(document.addEventListener("mousemove",ee,!1),document.addEventListener("mouseup",te,!1),r.dispatchEvent(a))}}function ee(e){if(!1!==r.enabled)switch(e.preventDefault(),l){case n.ROTATE:if(!1===r.enableRotate)return;U(e);break;case n.DOLLY:if(!1===r.enableZoom)return;B(e);break;case n.PAN:if(!1===r.enablePan)return;k(e);break}}function te(e){!1!==r.enabled&&(z(e),document.removeEventListener("mousemove",ee,!1),document.removeEventListener("mouseup",te,!1),r.dispatchEvent(s),l=n.NONE)}function re(e){!1===r.enabled||!1===r.enableZoom||l!==n.NONE&&l!==n.ROTATE||(e.preventDefault(),e.stopPropagation(),r.dispatchEvent(a),F(e),r.dispatchEvent(s))}function ie(e){!1!==r.enabled&&!1!==r.enableKeys&&!1!==r.enablePan&&H(e)}function oe(e){if(!1!==r.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(r.touches.ONE){case i["Cb"].ROTATE:if(!1===r.enableRotate)return;Y(e),l=n.TOUCH_ROTATE;break;case i["Cb"].PAN:if(!1===r.enablePan)return;I(e),l=n.TOUCH_PAN;break;default:l=n.NONE}break;case 2:switch(r.touches.TWO){case i["Cb"].DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;Q(e),l=n.TOUCH_DOLLY_PAN;break;case i["Cb"].DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;V(e),l=n.TOUCH_DOLLY_ROTATE;break;default:l=n.NONE}break;default:l=n.NONE}l!==n.NONE&&r.dispatchEvent(a)}}function ae(e){if(!1!==r.enabled)switch(e.preventDefault(),e.stopPropagation(),l){case n.TOUCH_ROTATE:if(!1===r.enableRotate)return;X(e),r.update();break;case n.TOUCH_PAN:if(!1===r.enablePan)return;J(e),r.update();break;case n.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;W(e),r.update();break;case n.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;G(e),r.update();break;default:l=n.NONE}}function se(e){!1!==r.enabled&&(q(e),r.dispatchEvent(s),l=n.NONE)}function ne(e){!1!==r.enabled&&e.preventDefault()}r.domElement.addEventListener("contextmenu",ne,!1),r.domElement.addEventListener("mousedown",$,!1),r.domElement.addEventListener("wheel",re,!1),r.domElement.addEventListener("touchstart",oe,!1),r.domElement.addEventListener("touchend",se,!1),r.domElement.addEventListener("touchmove",ae,!1),r.domElement.addEventListener("keydown",ie,!1),-1===r.domElement.tabIndex&&(r.domElement.tabIndex=0),this.update()};o.prototype=Object.create(i["t"].prototype),o.prototype.constructor=o;var a=function(e,t){o.call(this,e,t),this.mouseButtons.LEFT=i["N"].PAN,this.mouseButtons.RIGHT=i["N"].ROTATE,this.touches.ONE=i["Cb"].PAN,this.touches.TWO=i["Cb"].DOLLY_ROTATE};a.prototype=Object.create(i["t"].prototype),a.prototype.constructor=a},"93e9":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r("1b53"),o=function(e,t,r,o,a){i["a"].call(this),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=o,this.clearAlpha=void 0!==a?a:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};o.prototype=Object.assign(Object.create(i["a"].prototype),{constructor:o,render:function(e,t,r){var i,o,a,s=e.autoClear;e.autoClear=!1,void 0!==this.overrideMaterial&&(a=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(i=e.getClearColor().getHex(),o=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(i,o),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=a),e.autoClear=s}})},"9ab2":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r("5a89"),o=r("1b53"),a=r("e9d2"),s={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new i["n"](0)},defaultOpacity:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","\tgl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},n=function(e,t,r,n){o["a"].call(this),this.strength=void 0!==t?t:1,this.radius=r,this.threshold=n,this.resolution=void 0!==e?new i["Jb"](e.x,e.y):new i["Jb"](256,256),this.clearColor=new i["n"](0,0,0);var l={minFilter:i["I"],magFilter:i["I"],format:i["ob"]};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;var u=Math.round(this.resolution.x/2),h=Math.round(this.resolution.y/2);this.renderTargetBright=new i["Mb"](u,h,l),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var c=0;c<this.nMips;c++){var d=new i["Mb"](u,h,l);d.texture.name="UnrealBloomPass.h"+c,d.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(d);var m=new i["Mb"](u,h,l);m.texture.name="UnrealBloomPass.v"+c,m.texture.generateMipmaps=!1,this.renderTargetsVertical.push(m),u=Math.round(u/2),h=Math.round(h/2)}void 0===s&&console.error("UnrealBloomPass relies on LuminosityHighPassShader");var f=s;this.highPassUniforms=i["Ib"].clone(f.uniforms),this.highPassUniforms["luminosityThreshold"].value=n,this.highPassUniforms["smoothWidth"].value=.01,this.materialHighPassFilter=new i["ub"]({uniforms:this.highPassUniforms,vertexShader:f.vertexShader,fragmentShader:f.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var p=[3,5,7,9,11];for(u=Math.round(this.resolution.x/2),h=Math.round(this.resolution.y/2),c=0;c<this.nMips;c++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(p[c])),this.separableBlurMaterials[c].uniforms["texSize"].value=new i["Jb"](u,h),u=Math.round(u/2),h=Math.round(h/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms["blurTexture1"].value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms["blurTexture2"].value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms["blurTexture3"].value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms["blurTexture4"].value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms["blurTexture5"].value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms["bloomStrength"].value=t,this.compositeMaterial.uniforms["bloomRadius"].value=.1,this.compositeMaterial.needsUpdate=!0;var b=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms["bloomFactors"].value=b,this.bloomTintColors=[new i["Kb"](1,1,1),new i["Kb"](1,1,1),new i["Kb"](1,1,1),new i["Kb"](1,1,1),new i["Kb"](1,1,1)],this.compositeMaterial.uniforms["bloomTintColors"].value=this.bloomTintColors,void 0===a["a"]&&console.error("UnrealBloomPass relies on CopyShader");var v=a["a"];this.copyUniforms=i["Ib"].clone(v.uniforms),this.copyUniforms["opacity"].value=1,this.materialCopy=new i["ub"]({uniforms:this.copyUniforms,vertexShader:v.vertexShader,fragmentShader:v.fragmentShader,blending:i["a"],depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new i["n"],this.oldClearAlpha=1,this.basic=new i["S"],this.fsQuad=new o["a"].FullScreenQuad(null)};n.prototype=Object.assign(Object.create(o["a"].prototype),{constructor:n,dispose:function(){for(var e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()},setSize:function(e,t){var r=Math.round(e/2),o=Math.round(t/2);this.renderTargetBright.setSize(r,o);for(var a=0;a<this.nMips;a++)this.renderTargetsHorizontal[a].setSize(r,o),this.renderTargetsVertical[a].setSize(r,o),this.separableBlurMaterials[a].uniforms["texSize"].value=new i["Jb"](r,o),r=Math.round(r/2),o=Math.round(o/2)},render:function(e,t,r,i,o){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var a=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),o&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=r.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms["tDiffuse"].value=r.texture,this.highPassUniforms["luminosityThreshold"].value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);for(var s=this.renderTargetBright,l=0;l<this.nMips;l++)this.fsQuad.material=this.separableBlurMaterials[l],this.separableBlurMaterials[l].uniforms["colorTexture"].value=s.texture,this.separableBlurMaterials[l].uniforms["direction"].value=n.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[l]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[l].uniforms["colorTexture"].value=this.renderTargetsHorizontal[l].texture,this.separableBlurMaterials[l].uniforms["direction"].value=n.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[l]),e.clear(),this.fsQuad.render(e),s=this.renderTargetsVertical[l];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms["bloomStrength"].value=this.strength,this.compositeMaterial.uniforms["bloomRadius"].value=this.radius,this.compositeMaterial.uniforms["bloomTintColors"].value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms["tDiffuse"].value=this.renderTargetsHorizontal[0].texture,o&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(r),this.fsQuad.render(e)),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=a},getSeperableBlurMaterial:function(e){return new i["ub"]({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new i["Jb"](.5,.5)},direction:{value:new i["Jb"](.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})},getCompositeMaterial:function(e){return new i["ub"]({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}"})}}),n.BlurDirectionX=new i["Jb"](1,0),n.BlurDirectionY=new i["Jb"](0,1)},e9d2:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")}}}]);
//# sourceMappingURL=forcegraph~shaders~unrealbloom.cac2cfe2.js.map